# .htaccess file for GGI site

# Security: Block access to source files and configuration
# Block access to the source directory
RewriteRule ^_source/ - [F,L]

# Block access to any files starting with underscore
RewriteRule ^_.*$ - [F,L]

# Require authentication for admin section
<Directory "/path/to/your/site/admin">
    AuthType Basic
    AuthName "Admin Area"
    AuthUserFile /path/to/.htpasswd
    Require valid-user
</Directory>

# Alternative: Use location-based authentication
<Location "/admin">
    AuthType Basic
    AuthName "Admin Area"
    AuthUserFile /path/to/.htpasswd
    Require valid-user
</Location>

# Handle CGI script routing
Options +ExecCGI
AddHandler cgi-script .cgi .pl .py .php

# Route admin requests to the CGI script
RewriteCond %{REQUEST_URI} ^/admin/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /admin.cgi [QSA,L]